# 거주지 상태 관리

## 거주지 상태 분류

---

### 1. 사용 중 (`ACTIVE`)
- **설명**:  
  현재 **사용자가 거주 중인 활성화된 거주지**를 의미합니다.  
  예: 입주민이 특정 동-층-호에 거주 중이라면 그 거주지의 상태는 사용 중으로 설정됩니다.

- **행동/권한**:
    - 거주지 변경 요청 시 기존 거주지의 상태가 자동으로 ‘비어 있음’으로 변경.
    - 사용자는 해당 거주지에 대한 포인트, 알림 및 예약 기록과 연결된 데이터에 접근 가능.

- **사용 사례**:
    - 입주민이 승인 완료된 상태에서 특정 동/층/호에 거주하는 경우.

---

### 2. 비어 있음 (`INACTIVE`)
- **설명**:  
  아직 **주민이 거주하지 않는 상태**를 의미합니다.  
  신규로 생성된 거주지나, 기존에 거주하던 입주민이 퇴거한 상태에서 비어 있게 됩니다.

- **행동/권한**:
    - 관리자는 이 상태의 거주지들을 목록에서 열람하거나 다른 사용자의 등록 요청을 승인 가능.
    - 시스템에서는 향후 사용자를 연결하거나 추가할 준비 완료.

- **사용 사례**:
    - 새로 생성된 신규 동/층/호.
    - 기존 거주민이 거주지 변경 또는 퇴거 후 거주지가 비어 있는 경우.

---

### 3. 승인 대기 (`PENDING`)
- **설명**:  
  사용자가 신청했지만 아직 관리자의 **승인을 기다리는 상태**입니다.  
  관리자가 거주 승인 여부를 검토 중이며 해당 거주지는 확정되기 전입니다.

- **행동/권한**:
    - 사용자는 거주지 승인이 완료되기 전까지 거주지에 연결된 기능(예약, 알림 수신, 포인트 사용 등)을 사용할 수 없음.
    - 관리자는 승인 또는 거절 후 상태를 변경.

- **사용 사례**:
    - 기존 입주민이 없는 곳에 사용자가 새로 등록 신청한 경우.
    - 기존 입주민과 역할(Enum)로 구분되는 새로운 구성원이 추가 신청(예: 가족, 간병인 등).

---

### 4. 사용 불가 (`UNAVAILABLE`)
- **설명**:  
  특정한 이유로 **사용할 수 없는 거주지**입니다.  
  예: 리모델링, 임시 폐쇄, 문제 발생(전기, 수도 등 보수공사) 등의 이유로 해당 거주지를 거주 불가 상태로 설정.

- **행동/권한**:
    - 관리자는 이 상태의 거주지를 목록에서 제외하거나 사용자 등록 요청을 제한 가능.
    - 문제 해결 후 상태를 변경하거나 복구 가능.

- **사용 사례**:
    - 시스템에 의한 자동 처리(리모델링 등).
    - 관리자의 수동 처리(긴급 문제로 인한 임시 중단).

---

### 5. 삭제 (`DELETED`)
- **설명**:  
  시스템에서 삭제된 거주지를 의미합니다.  
  사용자가 퇴거하고 더 이상 사용되지 않는 데이터로 영구 삭제된 상태입니다.

- **행동/권한**:
    - 보존할 필요가 없는 데이터는 삭제 처리.
    - 데이터를 보존해야 하면 저장소에서 비식별화 상태로 처리 가능.

- **사용 사례**:
    - 동/층/호실 구조 변경으로 인한 거주지 삭제.
    - 관리자가 보존 필요 없는 데이터를 삭제 처리.

---

## 거주지 상태 전환 예시

| **현재 상태**         | **가능한 전환 상태**                   | **트리거**                                   |
|----------------------|-----------------------------------|---------------------------------------|
| **비어 있음 (`INACTIVE`)** | 승인 대기 (`PENDING`)               | 입주민 등록 요청.                             |
| 승인 대기 (`PENDING`)     | 사용 중 (`ACTIVE`), 비어 있음 (`INACTIVE`) | 관리자 승인/거절 처리.                        |
| 사용 중 (`ACTIVE`)        | 비어 있음 (`INACTIVE`), 사용 불가 (`UNAVAILABLE`) | 거주민 퇴거/관리자에 의한 제한 설정.                |
| 사용 불가 (`UNAVAILABLE`) | 비어 있음 (`INACTIVE`)               | 보수 작업 종료 후 정상화.                        |
| 삭제 (`DELETED`)         | 없음                              | 삭제된 데이터는 복구 불가.                          |

---

## 거주지 상태 관리의 중요성

1. **거주지 정보의 명확한 관리**
    - 거주지 상태 분류를 통해 관리자가 실시간으로 공간 활용 현황을 파악하고, 비어 있는 혹은 사용 중인 거주지의 상황을 효율적으로 처리 가능.

2. **사용자 요청 흐름 관리**
    - `PENDING` 상태처럼 사용자 요청 상태와 등록 승인을 명확히 구분하여 충돌을 방지.

3. **확장성 강화**
    - 거주지 추가, 삭제, 폐쇄 등의 다양한 상황에서도 시스템 전반의 안정성을 유지 가능.